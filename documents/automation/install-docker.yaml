schemaVersion: "0.3"
description: "Installs Docker if it's not already installed"
parameters:
  user:
    type: "String"
    description: "User to add to the docker group"
mainSteps:
  - name: "checkDocker"
    action: "aws:runShellScript"
    inputs:
      runCommand:
        - "docker --version"
    outputs:
      - Name: "dockerInstalled"
        Selector: "$?.ExitCode == 0"
        Type: "Boolean"
  - name: "installDocker"
    action: "aws:runShellScript"
    condition: "!checkDocker.dockerInstalled"
    inputs:
      runCommand:
        - sudo apt-get update -y
        - sudo apt-get install -y docker.io
        - sudo usermod -aG docker {{ user }}